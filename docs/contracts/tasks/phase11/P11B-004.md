Task ID: P11B-004
Rule ID: INV-BOUNDARY-TOLERANCE-001
Subsystem: PlayoutEngine, MetricsExporter
Task Type: METRIC
File(s) to Modify: pkg/air/src/runtime/PlayoutEngine.cpp, pkg/air/src/metrics/MetricsExporter.cpp
Owner: AIR
Blocked By: P11B-002

Instructions:
- Add counter metric for boundary timing violations
- Counter enables alerting on violation rate

---

Rule Definition:
Grid boundary transitions MUST complete within one video frame duration (33.33ms at 30fps) of the absolute scheduled boundary time.

Metric Specification:

Name: `retrovue_switch_boundary_violations_total`
Type: Counter
Labels: `channel_id`

Description: Total count of switches that exceeded the 1-frame tolerance.

Implementation:
```cpp
// In PlayoutEngine::legacy switch RPC() when violation detected:
if (delta_ms > tolerance_ms) {
    metrics_exporter_->IncrementBoundaryViolations(channel_id);
}
```

Prometheus Output Example:
```
retrovue_switch_boundary_violations_total{channel_id="1"} 3
retrovue_switch_boundary_violations_total{channel_id="2"} 0
```

Alert Rule (for reference, not part of this task):
```yaml
alert: HighBoundaryViolationRate
expr: rate(retrovue_switch_boundary_violations_total[5m]) > 0.1
```

Constraints:
- Counter only increments, never resets (standard Prometheus semantics)
- Increment happens when INV-BOUNDARY-TOLERANCE-001 VIOLATION log fires

Done Criteria:
Counter metric exposed at /metrics incrementing on each boundary violation.

---

Completion (2026-02-01): MetricsExporter.IncrementBoundaryViolations(); retrovue_switch_boundary_violations_total in GenerateMetricsText.
