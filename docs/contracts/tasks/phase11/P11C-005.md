Task ID: P11C-005
Rule ID: INV-BOUNDARY-DECLARED-001
Subsystem: Integration
Task Type: TEST
File(s) to Modify: pkg/air/tests/integration/BoundaryDeclarationTests.cpp (new file)
Owner: Test
Blocked By: P11C-003, P11C-004

Instructions:
- Create integration test verifying target_boundary_time_ms flows Coreâ†’AIR
- Test must exercise the full gRPC path

---

Rule Definition:
SwitchToLive MUST include `target_boundary_time_ms` parameter; Core declares intent, AIR executes at that time.

Test Scenario:
TEST_INV_BOUNDARY_DECLARED_001_TargetFlowsFromCoreToAir

- Given: Core with scheduled grid boundary at time T
- When: Core issues SwitchToLive
- Then: SwitchToLiveRequest contains target_boundary_time_ms = T
- And: AIR logs receipt of target_boundary_time_ms = T
- And: SwitchToLiveResponse contains switch_completion_time_ms

Test Implementation:

```cpp
TEST(BoundaryDeclarationTests, TargetFlowsFromCoreToAir) {
    // Setup: Create mock schedule with known boundary
    int64_t target_boundary_ms = GetNextGridBoundaryMs();

    // Act: Issue SwitchToLive via gRPC
    SwitchToLiveRequest request;
    request.set_channel_id(1);
    request.set_target_boundary_time_ms(target_boundary_ms);

    SwitchToLiveResponse response;
    auto status = stub_->SwitchToLive(&context, request, &response);

    // Assert: Request arrived with correct target
    ASSERT_TRUE(status.ok());
    EXPECT_GT(response.switch_completion_time_ms(), 0);

    // Assert: Logs show target received (check captured logs)
    EXPECT_TRUE(LogContains("INV-BOUNDARY-DECLARED-001: SwitchToLive received with target_boundary_time_ms=" +
                           std::to_string(target_boundary_ms)));
}
```

Assertions Required:
1. gRPC call succeeds
2. Request contains non-zero target_boundary_time_ms
3. Response contains non-zero switch_completion_time_ms
4. AIR log confirms receipt of target value

Done Criteria:
Integration test passes proving target_boundary_time_ms flows from Core to AIR.
