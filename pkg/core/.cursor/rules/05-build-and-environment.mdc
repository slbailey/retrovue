---
alwaysApply: true
---

# Build paths and environment (monorepo)

When running or building anything in this repo, follow these exactly.

## Python

- **Use the Core venv.** Before running `python`, `pytest`, or `pip` for RetroVue Core, activate:
  - **`source pkg/core/.venv/bin/activate`** (from repo root), or
  - **`source .venv/bin/activate`** (from `pkg/core/`).
- Do **not** use system `python`/`pytest` for Core; they will miss dependencies and may use the wrong interpreter.

## C++ (Air)

- **Build directory is fixed:** **`pkg/air/build`**.
- Always configure and build with:
  - `cmake -S pkg/air -B pkg/air/build ...`
  - `cmake --build pkg/air/build ...`
- Do **not** put the default C++ build elsewhere (e.g. not a top-level `build/`, not `pkg/air/build-asan` unless that variant is explicitly requested). Binaries and tests live under `pkg/air/build`.

## Proto (gRPC contract)

- **Single source of truth:** **`protos/playout.proto`** at repo root. There is no other copy; do not create one.
- **Generate stubs** from repo root: **`sh scripts/air/generate_proto.sh`**.
- **Python stubs** go to **`pkg/core/core/proto/retrovue/`**. Code that needs playout gRPC types loads from that directory.
- C++ stubs are generated by Airâ€™s CMake from the same `protos/playout.proto`.
